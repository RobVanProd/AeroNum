name: Aero Performance Benchmarks
on:
  push:
    branches:
      - main
  pull_request:

jobs:
  benchmark_dashboard:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Build Aero Toolchain
        run: |
          git clone https://github.com/RobVanProd/Aero.git /tmp/aero
          cd /tmp/aero
          cargo build --release
          echo "/tmp/aero/target/release" >> $GITHUB_PATH

      - name: Execute Aero Benchmark Suite
        run: |
          # Simulates the native benchmarking hook explicitly mapped through
          # the new aero-pkg router validating bounds limits
          aero test --bench

      - name: Generate Validation Dashboard
        run: |
          aero run --bin generate_dashboard

      - name: Publish Artifact (HTML Dashboard)
        uses: actions/upload-artifact@v3
        with:
          name: aeronum-dashboard
          path: benchmarks/dashboard/index.html
          retention-days: 30
          
      # Additional step natively deploying this artifact loop to GitHub Pages
      # ensuring continuous monitoring over the repository lifecycle.
